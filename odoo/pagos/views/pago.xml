<odoo>
    <!-- Acción de Menú (DEBE IR PRIMERO) -->
    <record id="action_pagos" model="ir.actions.act_window">
        <field name="name">Aplicar Pagos</field>
        <field name="res_model">pagos.pago</field>
        <field name="view_mode">list,form</field>
        <field name="context">{'default_periodo': 'OI'}</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">Aplicar pagos</p>
        </field>
    </record>

    <!-- Vista árbol -->
    <record id="view_pago_list" model="ir.ui.view">
        <field name="name">pagos.list</field>
        <field name="model">pagos.pago</field>
        <field name="arch" type="xml">
            <list>
                <field name="fecha"/>
                <field name="folio"/>
                <field name="metodo"/>
                <field name="observaciones"/>
                <field name="monto"/>
                <field name="status" widget="badge" decoration-success="status == 'posted'" decoration-danger="status == 'cancelled'"/>
            </list>
        </field>
    </record>

    <!-- Vista formulario -->
    <record id="view_pago_form" model="ir.ui.view">
        <field name="name">pagos.form</field>
        <field name="model">pagos.pago</field>
        <field name="arch" type="xml">
            <form autosave="False">
                <header>
                    <button name="action_aplicar_pago" string="Aplicar Pago" type="object" class="btn btn-success" icon="fa-check" invisible = "status != 'draft' or not id" confirm="Desea aplicar el pago? Después ya no podrá modificar ningún dato relacionado."/>
                    <button name="action_cancelar_pago" string="Cancelar Pago" type="object" class="btn btn-danger" icon="fa-times" invisible = "status != 'posted' or not id" confirm="El pago se cancelará, desea continuar?"/>
                    <field name="status" widget="statusbar" statusbar_visible="draft,posted,cancelled" invisible="not id"/>
                </header>
                <sheet>
                    <group>
                        <group>
                            <field name="fecha"/>
                        </group>
                        <group>
                            <field name="folio" invisible = "status == 'draft' or not id"/>
                        </group>
                        <group>
                            <field name="tipoventa" readonly="details"/>
                        </group>
                        <group></group>
                        <group>
                            <field name="cliente" readonly="details"/>
                        </group>
                        <group>
                            <field name="credito" invisible = "tipoventa == '0'"  readonly="details"/>
                        </group>
                        <group>
                            <field name="metodo"/>
                        </group>
                        <group>
                            <field name="banco"/>
                        </group>
                        <group>
                            <field name="observaciones"/>
                        </group>
                        <group></group>
                    </group>
                    <div style="margin: 10px 0; display: flex; gap: 15px;">
                        <button name="action_cargarventas" string="Ventas" type="object" class="btn btn-primary" icon="fa-plus" invisible="status != 'draft'"/>
                        <button name="action_cargarcargos" string="Cargos" type="object" class="btn-primary" icon="fa-plus" invisible = "tipoventa == '0' or status != 'draft'"/>
                        <button name="action_cargarcargos" string="Intereses" type="object" class="btn-primary" icon="fa-plus" invisible = "tipoventa == '0' or status != 'draft'"/>
                    </div>
                    <field name="details" nolabel="1" readonly="true">
                        <list>
                            <button name="action_eliminar" string="" type="object" class="btn-link" icon="fa-trash" invisible="pagostatus != 'draft'" width="30px" confirm="Desea eliminar este elemento?"/>
                            <field name="referencia"/>
                            <field name="descripcion"/>
                            <field name="saldo"/>
                            <field name="monto"/>
                        </list>
                    </field>
                    <group style="text-align: right;">
                        <field name="monto" style="text-align: right; font-weight: bold;"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Menús -->
    <menuitem id="menu_root" name="pagos" sequence="10" />
    <menuitem id="menu_action" name="pagos Agrícolas" parent="menu_root" action="action_pagos" />
</odoo>

